# 前台内容

## 准备工作

- 搭建目录结构

- 新建views文件夹

  ![image-20220927205110272](/Users/yuho/Library/Application Support/typora-user-images/image-20220927205110272.png)

- 新建public文件夹

  ![image-20220927205211573](/Users/yuho/Library/Application Support/typora-user-images/image-20220927205211573.png)

- 设置路由文件

- ![image-20220927205237768](/Users/yuho/Library/Application Support/typora-user-images/image-20220927205237768.png)

- app.js引入 静态页面

```js
//   app.js
...
//引入 path
const path = require('path')
...
// ---------------
// 引入静态资源
app.use(express.static(path.join(__dirname, 'public')))
```

## 模版引擎与路由处理

- 引入 ejs 模版引擎

```shell
npm i ejs
```

- 基础配置

```js
//     app.js
...
// 引入ejs
const ejs = require('ejs')
...
// 配置模版引擎
// 设置视图目录位置
app.set('views', path.join(__dirname, './views'))
// 设置视图引擎为 ejs 
app.set('view engine', 'ejs')
// 将 html 文件 通过 ejs 处理
app.engine('html', ejs.renderFile)
...
```

- 路由设置

```js
//   app.js
...
// 引入前台路由 文件
app.use(require('./routes/pages'))
...
```

```js
//    routes/pages/index.js
// 前台路由结构处理

// router实例
const Router = require('express').Router()

// 首页路由与分类路由 都设置在 index.html中
Router.get(['/', '/:cid'], (req, res) => {
  res.render('index.html')
})
// 文章页路由
Router.get('/articles/:articleId', (req, res) => {
  res.render('article.html')
})

// 导出
module.exports = Router
```

## TailwindCSS框架

### 基本配置和安装

https://www.tailwindcss.cn/docs/installation

- 安装

```shell
npm install -D tailwindcss@latest postcss@latest autoprefixer@latest
```

- 配置（需要哪些插件） 作为 PostCSS 插件来添加 Tailwind
  - 根目录新建postcss.config.js

```js
//   postcss.config.js
module.exports = {
  Plugins: [
    require('tailwindcss'),
    require('autoprefixer')
  ]
}
```

- 创建配置文件

  ```shell
  npx tailwindcss init
  ```

- 新建tailwind.css文件

```css
//     public/css/tailwin.css
@tailwin base;
@tailwin components;
@tailwin utilities;

```

- 新建dist文件夹 用于存放 生成的css

```shell
public/dist/complie.css
```

- 安装postcss脚手架工具

```shell
npm i postcss-cli
```

- 根据配置生成css文件

```shell
npx postcss ./public/css/tailwind.css -o ./public/dist/compile.css
```

- 将上条命令配置在package.json中

```json
"scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "css": "npx postcss ./public/css/tailwind.css -o ./public/dist/compile.css"
  }
```

```shell
再次使用时只需要 
npm run css
```

- 注意： 安装时安装下图版本，避免报错

  ![image-20220927224825490](/Users/yuho/Library/Application Support/typora-user-images/image-20220927224825490.png)

  

### 去除未使用样式

- 修改配置

```js
//   tailwind.config.js
module.exports = {
  // 用于配置不使用的样式 purge
  //  './views/**/*.html',  *代表模糊查找， 文件名使用一个*，文件夹名使用两个*
  purge: {
    enabled: true,
    content: [
      './views/**/*.html',
      './views/*.html'
    ]
  },
  darkMode: false, // or 'media' or 'class'
  theme: {
    extend: {},
  },
  variants: {
    extend: {},
  },
  plugins: [],
}

```

- 修改完成后重新生成

```shell
npm run css
```

- 每次使用完成后想要查看效果 都需要重新编译一次，也就是重新执行npm run css

### vscode插件

![image-20220927231558052](/Users/yuho/Library/Application Support/typora-user-images/image-20220927231558052.png)

- 用于tailwind css 语法提示

## 模版处理

- 提取公共区域到base.html中

```html
  views/layouts/base.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- 引入 -->
  <link rel="stylesheet" href="/dist/compile.css">
```

- 设置index.html
- 通过模版引擎引入 base、header、footer区域文件
- 模版引擎语法：
  - <%- include("./layouts/base.html")%>

```html
  views/index.html
<%- include("./layouts/base.html")%>
</head>
<body>
  <%- include("./layouts/header.html")%>
  <div>页面主题-shouye</div>
  <%- include("./layouts/footer.html")%>
</body>
</html>
```

- 设置article.html

```html
<%- include("./layouts/base.html")%>
</head>
<body>
  <%- include("./layouts/header.html")%>
  <div>页面主题-文章</div>
  <%- include("./layouts/footer.html")%>
</body>
</html>
```

